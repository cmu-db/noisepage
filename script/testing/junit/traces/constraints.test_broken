# BasicTableCreationTest
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, data TEXT);

statement ok
INSERT INTO TableA VALUES (1, 'abc');

# No of outputs = 1
query I nosort
SELECT * FROM pg_constraint;
----
Expected 1 values hashing to ad8bd57d7c490835b263b3639ecf5ebb

# No of outputs = 1
query IT nosort
SELECT * FROM TableA;
----
Expected 1 values hashing to ed8a800c13fbb0bdd40d632a346eebdd

statement ok
DROP TABLE TableA

# KCreationRestrictionSuccess
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, data INT UNIQUE, name TEXT UNIQUE);

statement ok
CREATE TABLE TableB (id INT PRIMARY KEY, fk1 INT references TableA(id));

statement error
CREATE TABLE TableC (id INT PRIMARY KEY, fk1 INT, fk2 TEXT, FOREIGN KEY (fk1, fk2) references TableA(id, name));

statement error
DROP TABLE TableA

statement ok
DROP TABLE TableB

statement error
DROP TABLE TableC

# FKCreationReferenceNoneUnique
statement error
CREATE TABLE TableA (id INT PRIMARY KEY, data INT, name TEXT UNIQUE);

# below statement should FAIL
statement error
CREATE TABLE TableC (id INT PRIMARY KEY, fk1 INT, fk2 TEXT REFERENCES TableA (data));

statement ok
DROP TABLE TableA

statement error
DROP TABLE TableC if EXISTS

# FKCreationIncludingNoneUnique
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, data INT, name TEXT UNIQUE);

# below statement should FAIL
statement error
CREATE TABLE TableC (id INT PRIMARY KEY, fk1 INT, fk2 TEXT, FOREIGN KEY (fk1, fk2) REFERENCES TableA (data, name));

statement ok
DROP TABLE TableA

statement error
DROP TABLE TableC if EXISTS

# FKCreationDisjointUniquePKConstraint
statement ok
CREATE TABLE TableA (id INT, data1 INT, data2 INT, data3 INT, data4 INT, data5 INT UNIQUE, PRIMARY KEY(id, data1));

# below statement should FAIL
statement error
CREATE TABLE TableC (id INT PRIMARY KEY, fk1 INT, fk2 INT, FOREIGN KEY (fk1, fk2) REFERENCES TableA (id, data5));

statement ok
DROP TABLE TableA

statement error
DROP TABLE TableC if EXISTS

# FKCreationRestrictionTrueComples3
statement ok
CREATE TABLE TableA (id INT, data1 INT, data2 INT, data3 INT, data4 INT, data5 INT UNIQUE, PRIMARY KEY(id, data1));

statement error
CREATE TABLE TableC (id INT PRIMARY KEY, fk1 INT, fk2 INT, fk3 INT, FOREIGN KEY (fk1, fk2, fk3) REFERENCES TableA (id, data1, data5));

statement ok
DROP TABLE TableA

statement error
DROP TABLE TableC

# FKCreationTypeMismatch
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, data INT, name TEXT UNIQUE);

# below statement should FAIL
statement error
CREATE TABLE TableC (id INT PRIMARY KEY, fk1 INT REFERENCES TableA(name));

statement ok
DROP TABLE TableA

statement error
DROP TABLE TableC if EXISTS

# CreateSinglePKTest
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, data TEXT);

statement ok
INSERT INTO TableA VALUES (1, 'abc');

# No of outputs = 1
query IT nosort
SELECT * FROM TableA;
----
Expected 1 values hashing to ed8a800c13fbb0bdd40d632a346eebdd

# No of outputs = 1
query I nosort
SELECT * FROM pg_constraint;
----
Expected 1 values hashing to 52ad921dae49f8a3034a9b12b6d74787

statement ok
DROP TABLE TableA

# CreateMultiplePKTest
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, data TEXT);

statement ok
CREATE TABLE TableB (id INT PRIMARY KEY, data TEXT);

statement ok
CREATE TABLE TableC (id INT PRIMARY KEY, data TEXT);

statement ok
INSERT INTO TableA VALUES (1, 'abc');

# No of outputs = 1
query IT nosort
SELECT * FROM TableA;
----
Expected 1 values hashing to ed8a800c13fbb0bdd40d632a346eebdd

# No of outputs = 3
query I nosort
SELECT * FROM pg_constraint;
----
Expected 3 values hashing to ce2436af7b543eaec578913f3f4683fd

statement ok
DROP TABLE TableA

statement ok
DROP TABLE TableB

statement ok
DROP TABLE TableC

# DeleteMultiplePKTest
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, data TEXT);

statement ok
CREATE TABLE TableB (id INT PRIMARY KEY, data TEXT);

statement ok
CREATE TABLE TableC (id INT PRIMARY KEY, data TEXT);

statement ok
INSERT INTO TableA VALUES (1, 'abc');

# No of outputs = 1
query IT nosort
SELECT * FROM TableA;
----
Expected 1 values hashing to ed8a800c13fbb0bdd40d632a346eebdd

# No of outputs = 3
query I nosort
SELECT * FROM pg_constraint;
----
Expected 3 values hashing to 4678a141ff1d3bdf9b75f4bf4da512a6

statement ok
DROP TABLE TableA

# No of outputs = 2
query I nosort
SELECT * FROM pg_constraint;
----
Expected 2 values hashing to d956b000ef4e09dabf7f19c7120caf6c

statement ok
DROP TABLE TableC

# No of outputs = 1
query I nosort
SELECT * FROM pg_constraint;
----
Expected 1 values hashing to 821dadc4555108ac084de87204d06363

statement ok
DROP TABLE TableB

# No of outputs = 0
query I nosort
SELECT * FROM pg_constraint;
----
Expected 0 values hashing to c9cefb73c237fbe90c918616aafb9611

# CreateUNIQUETest
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, number INT UNIQUE, data TEXT);

statement ok
INSERT INTO TableA VALUES (1, 1, 'abc');

# No of outputs = 1
query IIT nosort
SELECT * FROM TableA
----
Expected 1 values hashing to 53ac14f823377b8f2b1dc7b1ccb87a2e

# No of outputs = 2
query I nosort
SELECT * FROM pg_constraint
----
Expected 2 values hashing to d012b34104785efec1fdb2fa4fe50b92

statement ok
DROP TABLE TableA

# CreateMultipleFKTest
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, data TEXT);

statement ok
CREATE TABLE TableB (id INT PRIMARY KEY, fk1 INT references TableA(id));

statement error
CREATE TABLE TableC (id INT PRIMARY KEY, fk2 INT references TableB(fk1));

statement ok
INSERT INTO TableA VALUES (1, 'abc');

# No of outputs = 1
query IT nosort
SELECT * FROM TableA
----
Expected 1 values hashing to ed8a800c13fbb0bdd40d632a346eebdd

# No of outputs = 5
query I nosort
SELECT * FROM pg_constraint
----
Expected 5 values hashing to 3b5f7597bdd47f8f4373e04710525dd2

statement error
DROP TABLE TableA

statement ok
DROP TABLE TableB

statement error
DROP TABLE TableC

# DropUNIQUETest
statement error
CREATE TABLE TableA (id INT PRIMARY KEY, data TEXT);

statement error
INSERT INTO TableA VALUES (1, 'abc');

# No of outputs = 1
query IT nosort
SELECT * FROM TableA
----
Expected 1 values hashing to ed8a800c13fbb0bdd40d632a346eebdd

query I nosort
SELECT * FROM pg_constraint
----
75 values hashing to 8023cbbb6d6eaaf2a60f5adb050b98d5

statement ok
DROP TABLE TableA

# No of outputs = 0
query I nosort
SELECT * FROM pg_constraint
----
Expected 0 values hashing to c9cefb73c237fbe90c918616aafb9611

# DeleteMultipleFKTest
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, data TEXT);

statement ok
CREATE TABLE TableB (id INT PRIMARY KEY, fk1 INT references TableA(id));

statement error
CREATE TABLE TableC (id INT PRIMARY KEY, fk2 INT references TableB(fk1));

statement ok
INSERT INTO TableA VALUES (1, 'abc');

# No of outputs = 1
query IT nosort
SELECT * FROM TableA
----
Expected 1 values hashing to ed8a800c13fbb0bdd40d632a346eebdd

# No of outputs = 5
query I nosort
SELECT * FROM pg_constraint
----
Expected 5 values hashing to 88b8734ea5630c26c6d9a5ad6268ce57

statement ok
DROP TABLE TableB

statement error
DROP TABLE TableC

# No of outputs = 1
query I nosort
SELECT * FROM pg_constraint
----
Expected 1 values hashing to e8a1f28cd1f010b013e804cf401a9afa

statement ok
Drop Table TableA

# EnforcePKTest
statement ok
CREATE TABLE TableA (id INT PRIMARY KEY, data TEXT);

statement ok
INSERT INTO TableA VALUES (1, 'abc');

# No of outputs = 1
query IT nosort
SELECT * FROM TableA;
----
Expected 1 values hashing to ed8a800c13fbb0bdd40d632a346eebdd

# No of outputs = 1
query I nosort
SELECT * FROM pg_constraint;
----
Expected 1 values hashing to def8eb65e1ffb677bbba00d00a0d6c23

# No of outputs = 1
query IT nosort
SELECT * FROM TableA;
----
Expected 1 values hashing to ed8a800c13fbb0bdd40d632a346eebdd

statement ok
INSERT INTO TableA VALUES (2, 'abc');

# No of outputs = 2
query IT nosort
SELECT * FROM TableA;
----
Expected 2 values hashing to 7ff392b19cd472f333bbd20a5c67145a

statement ok
DROP TABLE TableA

