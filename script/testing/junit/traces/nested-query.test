statement ok
DROP TABLE IF EXISTS shipment;

statement ok
DROP TABLE IF EXISTS supplier;

statement ok
DROP TABLE IF EXISTS part;

statement ok
CREATE TABLE shipment (sno int, pno int, qty int);

statement ok
CREATE TABLE supplier (sno int, sloc int, subdget int);

statement ok
CREATE TABLE part (pno int, price int);

statement ok


statement ok
-- Test TypeA, max

statement ok
INSERT INTO shipment VALUES (2, 2, 2);

statement ok
INSERT INTO shipment VALUES (1, 1, 1);

statement ok
INSERT INTO shipment VALUES (3, 3, 3);

statement ok
INSERT INTO part VALUES (1, 30);

statement ok
INSERT INTO part VALUES (2, 30);

query I nosort
SELECT sno FROM shipment WHERE pno = (SELECT MAX(pno) FROM part WHERE price = 30);
----
1 values hashing to 26ab0db90d72e28ad0ba1e22ee510510

statement ok


statement ok
-- Test TypeA, max, multiple results

query I nosort
SELECT sno FROM shipment WHERE pno = (SELECT MAX(pno) FROM part WHERE price = 30);
----
1 values hashing to 26ab0db90d72e28ad0ba1e22ee510510

statement ok


statement ok
-- Test TypeA, max, not equal

query I nosort
SELECT sno FROM shipment WHERE pno != (SELECT MAX(pno) FROM part WHERE price = 30);
----
2 values hashing to 0a88863510308751293f4b91afc07dd6

statement ok


statement ok
-- Test TypeA, max, greater than

query I nosort
SELECT sno FROM shipment WHERE pno > (SELECT MAX(pno) FROM part WHERE price = 30);
----
1 values hashing to 6d7fce9fee471194aa8b5b6e47267f03

statement ok


statement ok
-- Test TypeA, max, less than

query I nosort
SELECT sno FROM shipment WHERE pno < (SELECT MAX(pno) FROM part WHERE price = 30);
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

statement ok


statement ok
-- Test TypeA, max, greater than or equal to

query I nosort
SELECT sno FROM shipment WHERE pno >= (SELECT MAX(pno) FROM part WHERE price = 30);
----
2 values hashing to 19283599a9866154a20cbb0be6adc1bc

statement ok


statement ok
-- Test TypeA, max, less than or equal to

query I nosort
SELECT sno FROM shipment WHERE pno <= (SELECT MAX(pno) FROM part WHERE price = 30);
----
2 values hashing to cb0e93933b5e2202825f38da7587cf07

statement ok


statement ok
-- Test TypeA, sum

query I nosort
SELECT sno FROM shipment WHERE pno = (SELECT SUM(pno) FROM part WHERE price = 30);
----
1 values hashing to 6d7fce9fee471194aa8b5b6e47267f03

statement ok


statement ok
-- Test TypeN

statement ok
DROP TABLE IF EXISTS shipment;

statement ok
DROP TABLE IF EXISTS supplier;

statement ok
DROP TABLE IF EXISTS part;

statement ok
CREATE TABLE shipment (sno int, pno int, qty int);

statement ok
CREATE TABLE supplier (sno int, sloc int, subdget int);

statement ok
CREATE TABLE part (pno int, price int);

statement ok
INSERT INTO shipment VALUES (2, 2, 1);

statement ok
INSERT INTO shipment VALUES (1, 1, 1);

statement ok
INSERT INTO supplier VALUES (1, 1, 1);

statement ok
INSERT INTO supplier VALUES (1, 2, 1);

query I nosort
SELECT pno FROM shipment WHERE sno in (SELECT sno FROM supplier);
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

statement ok


statement ok
-- Test TypeN, Multiple results

query I nosort
SELECT pno FROM shipment WHERE sno in (SELECT sno FROM supplier);
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

statement ok


statement ok
-- Test TypeN, limit

statement ok
INSERT INTO supplier VALUES (2, 2, 1);

query I nosort
SELECT pno FROM shipment WHERE sno in (SELECT sno FROM supplier limit 1);
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

statement ok


statement ok
-- Test TypeN, Multiple nested layers

statement ok
DROP TABLE IF EXISTS shipment;

statement ok
DROP TABLE IF EXISTS supplier;

statement ok
DROP TABLE IF EXISTS part;

statement ok
CREATE TABLE shipment (sno int, pno int, qty int);

statement ok
CREATE TABLE supplier (sno int, sloc int, subdget int);

statement ok
CREATE TABLE part (pno int, price int);

statement ok
INSERT INTO shipment VALUES (2, 2, 1);

statement ok
INSERT INTO shipment VALUES (1, 1, 1);

statement ok
INSERT INTO supplier VALUES (2, 2, 2);

statement ok
INSERT INTO supplier VALUES (1, 2, 1);

query I nosort
SELECT pno FROM shipment WHERE sno in (SELECT sno FROM supplier WHERE subdget in (SELECT qty FROM shipment));
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

statement ok


statement ok
-- Test TypeN, EXISTS

query I nosort
SELECT pno FROM shipment WHERE EXISTS (SELECT sno FROM supplier WHERE sno > 1);
----
2 values hashing to cb0e93933b5e2202825f38da7587cf07

statement ok


statement ok
-- Test TypeN, greater than equal to any

query I nosort
SELECT pno FROM shipment WHERE shipment.sno = ANY (SELECT sno FROM supplier);
----
2 values hashing to cb0e93933b5e2202825f38da7587cf07

statement ok


statement ok
-- Test TypeJ

query I nosort
SELECT pno FROM shipment WHERE sno in (SELECT sno FROM supplier WHERE subdget = qty);
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

statement ok


statement ok
-- Test TypeJ, limit

statement ok
DROP TABLE IF EXISTS shipment;

statement ok
DROP TABLE IF EXISTS supplier;

statement ok
DROP TABLE IF EXISTS part;

statement ok
CREATE TABLE shipment (sno int, pno int, qty int);

statement ok
CREATE TABLE supplier (sno int, sloc int, subdget int);

statement ok
CREATE TABLE part (pno int, price int);

statement ok
INSERT INTO shipment VALUES (2, 2, 1);

statement ok
INSERT INTO shipment VALUES (1, 1, 2);

statement ok
INSERT INTO supplier VALUES (2, 1, 1);

statement ok
INSERT INTO supplier VALUES (1, 1, 1);

statement ok
INSERT INTO supplier VALUES (1, 2, 2);

query I nosort
SELECT pno FROM shipment WHERE sno in (SELECT sno FROM supplier WHERE subdget = qty limit 1);
----
2 values hashing to cb0e93933b5e2202825f38da7587cf07

statement ok


statement ok
-- Test TypeJA, less than max

statement ok
DROP TABLE IF EXISTS shipment;

statement ok
DROP TABLE IF EXISTS supplier;

statement ok
DROP TABLE IF EXISTS part;

statement ok
CREATE TABLE shipment (sno int, pno int, qty int);

statement ok
CREATE TABLE supplier (sno int, sloc int, subdget int);

statement ok
CREATE TABLE part (pno int, price int);

statement ok
INSERT INTO shipment VALUES (1, 2, 1);

statement ok
INSERT INTO shipment VALUES (2, 1, 1);

statement ok
INSERT INTO supplier VALUES (1, 1, 1);

statement ok
INSERT INTO supplier VALUES (2, 1, 1);

query I nosort
SELECT pno FROM shipment WHERE sno < (SELECT max(sno) FROM supplier WHERE subdget = qty);
----
1 values hashing to 26ab0db90d72e28ad0ba1e22ee510510

statement ok


statement ok
-- Test TypeJA, equal to max

statement ok
DROP TABLE IF EXISTS shipment;

statement ok
DROP TABLE IF EXISTS supplier;

statement ok
DROP TABLE IF EXISTS part;

statement ok
CREATE TABLE shipment (sno int, pno int, qty int);

statement ok
CREATE TABLE supplier (sno int, sloc int, subdget int);

statement ok
CREATE TABLE part (pno int, price int);

statement ok
INSERT INTO shipment VALUES (2, 2, 2);

statement ok
INSERT INTO shipment VALUES (1, 2, 1);

statement ok
INSERT INTO supplier VALUES (1, 1, 1);

statement ok
INSERT INTO supplier VALUES (2, 1, 1);

query I nosort
SELECT pno FROM shipment WHERE sno = (SELECT min(sno) FROM supplier WHERE subdget = qty);
----
1 values hashing to 26ab0db90d72e28ad0ba1e22ee510510

statement ok


statement ok


