query I nosort
with cte(x) as (select 1) select x FROM cte;
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

query I nosort
with cte as (select 1) select * FROM cte;
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

query I nosort
with cte as (select 1 as "x") select * FROM cte;
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

query I nosort
with cte(y) as (select 1 as "x") select y FROM cte;
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

query I nosort
WITH cte(x) AS (WITH cte2(y) AS (SELECT 1) SELECT y FROM cte2) SELECT x FROM cte;
----
1 values hashing to b026324c6904b2a9cb4b88d6d61c81d1

query I nosort
WITH cte(x) AS (SELECT 1), cte2(y) AS (SELECT 2) SELECT * FROM cte INNER JOIN cte2 ON cte.x+1 = cte2.y;
----
2 values hashing to cb0e93933b5e2202825f38da7587cf07

statement ok
CREATE TABLE tree (node INTEGER, parent INTEGER);

statement ok
INSERT INTO tree VALUES (1,NULL), (10, 1), (11, 1), (100, 10), (101, 10), (110, 11), (111, 11);

query I nosort
WITH RECURSIVE cte(x) AS (SELECT 1 UNION ALL SELECT tree.node FROM tree INNER JOIN cte ON tree.parent=cte.x) SELECT * FROM cte;
----
7 values hashing to e0147388525f89cdac23192c19c5cc75

query I nosort
with cte(x,x) as (select 1, 2) select * from cte;
----
2 values hashing to cb0e93933b5e2202825f38da7587cf07

query I nosort
with cte as (select 4, 3) select * from cte;
----
2 values hashing to 59dd3f9ecdec2a5dc45c99b7b093f8bf

query I nosort
with cte(y,y,x) as (select 5,4,3) select x from cte;
----
1 values hashing to 6d7fce9fee471194aa8b5b6e47267f03

